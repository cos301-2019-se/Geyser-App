<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">



<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
   
 
 <style> 
input[type=text] 
{
  width: 100%;
  padding: 12px 20px;
  margin: 8px 0;
  box-sizing: border-box;
}
</style>

</head>
<script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.4/firebase-app.js"></script>
 <script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.0.2/firebase-storage.js"></script>


<body>


<p><strong>Note:</strong> Plumber's details can be copy-pasted below from the CV else you can manually type it out </p>
    <textarea id="comment" rows="20" cols="100"></textarea>
    <p><button type="button" onclick = send()>Auto fill</button></p>
	
	


<label>Name</label>
    <input type="text" name="textbox3" id="textbox3" />
	
<label>ID number</label>
    <input type="text" name="textbox6" id="textbox6" />
    
<label>Cell Number</label>
    <input type="text" name="textbox7" id="textbox7" />
	
<label>Address</label>
    <input type="text" name="textbox8" id="textbox8" />

	
	
<label>Plumber ID</label>
    <input type="text" name="textbox9" id="textbox9" />
   <p><button type="button" onclick = genPlumberID()>Generate Plumber ID</button></p>
  
  
<label>Plumber Password</label>
    <input type="text" name="textbox10" id="textbox10" />
   <p><button type="button" onclick = genPlumberPassword()>Generate Plumber Password</button></p>
  
	
	
	
	
<label>Attach CV</label>
   <input type="file" id="fileButton1"/>
   
<label>Attach ID copy</label>
<input type="file" id="fileButton2"/>

<label>Attach other supporting documents</label>
<input type="file" id="fileButton3"/>

<br>
<br>
<br>
<button type="submit" onclick = "storeData()">Submit</button>
 
  
<script>

var firebaseConfig = {
    apiKey: "AIzaSyDibg-oYRpVXU9HqCAOLdxIpYXcZUPpAGM",
    authDomain: "geyser-74ddf.firebaseapp.com",
    databaseURL: "https://geyser-74ddf.firebaseio.com",
    projectId: "geyser-74ddf",
    storageBucket: "geyser-74ddf.appspot.com",
    messagingSenderId: "1001903322970",
    appId: "1:1001903322970:web:a904b91e99d67b22"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  var db = firebase.firestore();
  
  
  var fileButton1 = document.getElementById("fileButton1");
 fileButton1.addEventListener('change', function(e){
 var file1 = e.target.files[0];
 
 var storageRef1 = firebase.storage().ref("Workers Details");
 var secondref1 = storageRef1.child(document.getElementById("textbox9").value);
 var imagesRef1 = secondref1.child(file1.name);
 imagesRef1.put(file1);
 }); 
 
 
 
  var fileButton2 = document.getElementById("fileButton2");
 fileButton2.addEventListener('change', function(f){
 var file2 = f.target.files[0];
 
 var storageRef = firebase.storage().ref("Workers Details");
 var secondref = storageRef.child(document.getElementById("textbox9").value);
 var imagesRef = secondref.child(file2.name);
 imagesRef.put(file2);
 }); 
 
 
  var fileButton3 = document.getElementById("fileButton3");
 fileButton3.addEventListener('change', function(g){
 var file3 = g.target.files[0];
 
 var storageRef3 = firebase.storage().ref("Workers Details");
 var secondref3 = storageRef3.child(document.getElementById("textbox9").value);
 var imagesRef3 = secondref3.child(file3.name);
 imagesRef3.put(file3);
 }); 
 

 // gets the birth date only
 function idNumber()
{
	var id = document.getElementById("textbox6").value;
	
	var date = id.slice(0,6);
	var finalDate = date[0]+date[1]+"/"+date[2]+date[3]+"/"+date[4]+date[5];
	return finalDate;

} 
  
function genPlumberID()
 {
        var text = "24";
        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
           for(var i = 0; i < 8; i++) 
          {
             text += possible.charAt(Math.floor(Math.random() * possible.length));
           }
        document.getElementById("textbox9").value = text;
          
 }
 
 
 function genPlumberPassword()
 {
        var text = " ";
        var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789#@&*";
          for(var i = 0; i < 8; i++) 
          {
             text += possible.charAt(Math.floor(Math.random() * possible.length));
          }
        document.getElementById("textbox10").value = text;
          
 }
 
 
 
 function send()
  {
            var emptyArray = []; // create an empty array
           
            
            var lines = $('#comment').val().split('\n');
            for(var i = 0;i < lines.length;i++)
            {
                  var str = lines[i]; 
 				          var index = str.search(":");
  				         var res = str.slice(index+1, str.length);
                  emptyArray[i] = res
			}
           
            document.getElementById("textbox3").value = emptyArray[0];
			document.getElementById("textbox6").value = emptyArray[1];
            document.getElementById("textbox7").value = emptyArray[2];
			document.getElementById("textbox8").value = emptyArray[3];
			
  }
 


function idGender()
{
  
  var x = document.getElementById("textbox6").value;
  
  var str = x.slice(6,10);
  
  
  var gender= "";
  if(str > 0000 && str < 4999) 
  {
      gender = "female";
  }
  else
  {
	  gender = "male";
  
  }
  
 
return gender;


}




 
function storeData()
{
var name1 = document.getElementById('textbox3').value;
var DateOfBirth1 = idNumber();
var gender1 = idGender();
var idNumber1 = document.getElementById('textbox6').value;
var cellNumber1 = document.getElementById('textbox7').value;
var address1 = document.getElementById('textbox8').value;
var plumberID1 = document.getElementById('textbox9').value;

var plumberPassword = document.getElementById('textbox10').value;

db.collection("employeesDetails").doc(plumberID1).set(
{
fullName: name1,
DateOfBirth :DateOfBirth1,
gender:gender1,
idNumber:idNumber1,
cellNumber:cellNumber1,
address : address1,
plumberID : plumberID1

}
)

db.collection("users").doc(plumberID1).set(
{

password : plumberPassword,
userType : "plumber"

}
)

}

</script>
	
  
  
</body>

</html>
